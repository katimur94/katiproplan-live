<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KaTiProPlan - Live Update</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #111827; }
        details > summary { list-style: none; }
        details > summary::-webkit-details-marker { display: none; }
        details > summary::before {
            content: 'â–º'; margin-right: 0.75rem; font-size: 0.7em; color: #9CA3AF;
            transition: transform 0.2s ease-in-out;
        }
        details[open] > summary::before { transform: rotate(90deg); color: #60A5FA; }
        .summary-bar {
            background-image: linear-gradient(to right, #1E3A8A, #1C336E);
            border: 1px solid rgba(96, 165, 250, 0.3);
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 antialiased">

    <div class="min-h-screen container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-8 pt-4">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-white">KaTiProPlan</h1>
            <p id="timestamp" class="text-gray-400 mt-2 text-sm"></p>
        </header>

        <main>
            <section class="mb-12 p-6 rounded-2xl summary-bar shadow-xl">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
                    <div><p class="text-sm font-medium text-blue-200">Stutzen</p><p id="stutzen-count" class="text-3xl font-extrabold text-white mt-1">0</p></div>
                    <div><p class="text-sm font-medium text-blue-200">K-Liner</p><p id="kliner-count" class="text-3xl font-extrabold text-white mt-1">0</p></div>
                    <div><p class="text-sm font-medium text-blue-200">Projekte</p><p id="total-projects-count" class="text-3xl font-extrabold text-white mt-1">0</p></div>
                    <div><p class="text-sm font-medium text-blue-200">Gesamt</p><p id="total-sanierungen-count" class="text-3xl font-extrabold text-white mt-1">0</p></div>
                </div>
            </section>

            <section id="results-container" class="max-w-5xl mx-auto space-y-4"></section>
        </main>
    </div>

    <script>
        // --- HIER PASSIERT DIE MAGIE ---
        // Python wird "null" durch die echten Daten ersetzen.
        const PROJECT_DATA = {"projects": {"55104 Dorsten": {"stutzenSaniert": 2, "klinerSaniert": 0, "streets": {"Mittelstra\u00dfe": {"2123 - 2122": {"ges. Haltung": {"files": [{"name": "1 vor san..mp4", "url": "", "date": "2025-12-01", "type": "video/mp4"}, {"name": "2 nach fr\u00e4sen.mp4", "url": "", "date": "2025-12-02", "type": "video/mp4"}], "dates": ["2025-12-01", "2025-12-02"], "isSaniert": false}, "17,00m Muffe": {"files": [{"name": "1 vor san..mp4", "url": "", "date": "2025-12-02", "type": "video/mp4"}, {"name": "2 nach verschlie\u00dfen .mp4", "url": "", "date": "2025-12-02", "type": "video/mp4"}], "dates": ["2025-12-02"], "isSaniert": true}, "19,10m Muffe": {"files": [{"name": "1 vor san..mp4", "url": "", "date": "2025-12-02", "type": "video/mp4"}, {"name": "2 nach verschlie\u00dfen .mp4", "url": "", "date": "2025-12-02", "type": "video/mp4"}], "dates": ["2025-12-02"], "isSaniert": true}, "26,20m Muffe": {"files": [{"name": "1 vor san..mp4", "url": "", "date": "2025-12-02", "type": "video/mp4"}, {"name": "2 nach verschlie\u00dfen .mp4", "url": "", "date": "2025-12-02", "type": "video/mp4"}], "dates": ["2025-12-02"], "isSaniert": true}, "12,20m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen .mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}, {"name": "2 nach san..mp4", "url": "", "date": "2025-12-12", "type": "video/mp4"}], "dates": ["2025-12-04", "2025-12-12"], "isSaniert": true}, "15,60m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen .mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}, "16,80m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen .mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}, "25,80m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen .mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}, "3,30m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen .mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}, "31,90m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen.mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}}, "4119 - 2123": {"18,40m Stutzen": {"files": [{"name": "1 vor san..mp4", "url": "", "date": "2025-12-01", "type": "video/mp4"}, {"name": "2 nach fr\u00e4sen.mp4", "url": "", "date": "2025-12-01", "type": "video/mp4"}, {"name": "3 nach \u00f6ffnen.mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-01", "2025-12-04"], "isSaniert": false}, "ges. Haltung": {"files": [{"name": "1 vor san..mp4", "url": "", "date": "2025-12-01", "type": "video/mp4"}, {"name": "2 nach fr\u00e4sen.mp4", "url": "", "date": "2025-12-01", "type": "video/mp4"}], "dates": ["2025-12-01"], "isSaniert": false}, "12,90m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen.mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}, "21,80m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen.mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}, "34,10m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen.mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}, "35,00m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen.mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}}, "2121 - 2160": {"8,30m Stutzen": {"files": [{"name": "1 vor san..mp4", "url": "", "date": "2025-12-03", "type": "video/mp4"}, {"name": "2 nach fr\u00e4sen.mp4", "url": "", "date": "2025-12-03", "type": "video/mp4"}, {"name": "3 nach san..mp4", "url": "", "date": "2025-12-03", "type": "video/mp4"}, {"name": "4 nach Nacharbeit.mp4", "url": "", "date": "2025-12-03", "type": "video/mp4"}, {"name": "5 nach \u00f6ffnen.mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-03", "2025-12-04"], "isSaniert": true}, "ges. Haltung": {"files": [{"name": "1 vor san..mp4", "url": "", "date": "2025-12-03", "type": "video/mp4"}], "dates": ["2025-12-03"], "isSaniert": false}, "28,20m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen .mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}}, "2122 - 2121": {"17,20m Stutzen": {"files": [{"name": "1 vor san..mp4", "url": "", "date": "2025-12-03", "type": "video/mp4"}, {"name": "2 nach fr\u00e4sen.mp4", "url": "", "date": "2025-12-03", "type": "video/mp4"}, {"name": "3 nach \u00f6ffnen.mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-03", "2025-12-04"], "isSaniert": false}, "ges. Haltung": {"files": [{"name": "1 vor san..mp4", "url": "", "date": "2025-12-03", "type": "video/mp4"}, {"name": "2 vor san..mp4", "url": "", "date": "2025-12-03", "type": "video/mp4"}], "dates": ["2025-12-03"], "isSaniert": false}, "0,80m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen .mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}, "23,70m Stutzen": {"files": [{"name": "1 nach \u00f6ffnen .mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": false}}}}}, "55098 Datteln": {"stutzenSaniert": 1, "klinerSaniert": 0, "streets": {"Neuer Weg": {"S65.09": {"11,10m Stutzen": {"files": [{"name": "1 vor san..mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}, {"name": "2 nach verschlie\u00dfen .mp4", "url": "", "date": "2025-12-04", "type": "video/mp4"}], "dates": ["2025-12-04"], "isSaniert": true}}}}}}, "stats": {"stutzen": 3, "kliner": 0, "totalProjects": 2, "gesamtSaniert": 6}};
        // -------------------------------

        document.addEventListener('DOMContentLoaded', () => {
            if (PROJECT_DATA) {
                document.getElementById('timestamp').innerText = "Stand: " + new Date().toLocaleString();
                updateDashboard(PROJECT_DATA.stats);
                renderProjects(PROJECT_DATA.projects);
            } else {
                document.getElementById('results-container').innerHTML = '<p class="text-center text-red-500">Keine Daten injiziert.</p>';
            }
        });

        function updateDashboard(stats) {
            if(!stats) return;
            document.getElementById('stutzen-count').textContent = stats.stutzen || 0;
            document.getElementById('kliner-count').textContent = stats.kliner || 0;
            document.getElementById('total-projects-count').textContent = stats.totalProjects || 0;
            document.getElementById('total-sanierungen-count').textContent = stats.gesamtSaniert || 0;
        }

        function renderProjects(projects) {
            const container = document.getElementById('results-container');
            container.innerHTML = '';
            
            Object.keys(projects).sort().forEach(projectName => {
                const pData = projects[projectName];
                const subtitle = `STZ: ${pData.stutzenSaniert} | KL: ${pData.klinerSaniert}`;
                const pElem = createDetails(projectName, 0, 'blue', subtitle);
                
                Object.keys(pData.streets).sort().forEach(streetName => {
                    const sElem = createDetails(streetName, 1, 'teal');
                    const ids = pData.streets[streetName];
                    
                    Object.keys(ids).sort().forEach(idName => {
                        const iElem = createDetails(idName, 2, 'sky');
                        const dmgs = ids[idName];
                        
                        Object.keys(dmgs).sort().forEach(dmgName => {
                            const dData = dmgs[dmgName];
                            const dColor = dData.isSaniert ? 'green' : 'amber';
                            const dElem = createDetails(dmgName, 3, dColor, dData.dates.join(', '));
                            
                            const ul = document.createElement('ul');
                            ul.className = 'pl-4 pt-2 space-y-2';
                            
                            dData.files.forEach(f => {
                                const li = document.createElement('li');
                                li.className = 'flex items-center p-2 bg-gray-800 rounded border border-gray-700';
                                li.innerHTML = `
                                    <span class="text-gray-400 mr-2">${f.type.includes('video') ? 'ðŸŽ¥' : 'ðŸ“·'}</span>
                                    <span class="text-gray-200 text-sm truncate flex-1">${f.name}</span>
                                    <span class="text-xs text-gray-500 ml-2">${f.date}</span>
                                `;
                                ul.appendChild(li);
                            });
                            
                            dElem.appendChild(ul);
                            iElem.appendChild(dElem);
                        });
                        sElem.appendChild(iElem);
                    });
                    pElem.appendChild(sElem);
                });
                container.appendChild(pElem);
            });
        }

        function createDetails(title, level, color, sub = '') {
            const d = document.createElement('details');
            d.className = 'bg-gray-800/40 rounded-lg mb-2 border border-gray-700/50';
            if(level > 0) d.style.marginLeft = (level * 1) + 'rem';
            
            const s = document.createElement('summary');
            s.className = `p-3 cursor-pointer flex justify-between items-center text-white hover:bg-gray-700/50 rounded-lg`;
            s.innerHTML = `<div class="flex items-center gap-2"><span class="text-${color}-400 font-bold">ðŸ“‚</span><span class="font-medium">${title}</span></div>${sub ? `<span class="text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded">${sub}</span>` : ''}`;
            d.appendChild(s);
            return d;
        }
    </script>
</body>
</html>